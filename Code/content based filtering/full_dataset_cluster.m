%% Import data from spreadsheet
% Script for importing data from the following spreadsheet:
%
%    Workbook: C:\Users\Monika\Desktop\papers\adataset\xcell.xlsx
%    Worksheet: Sheet1
%
% To extend the code for use with different selected data or a different
% spreadsheet, generate a function instead of a script.

% Auto-generated by MATLAB on 2015/09/19 09:56:01

%% Import the data
[~, ~, raw] = xlsread('D:\STUDIES_MSBR\Academics\BTProject\Final Project\BTP(ipg2012-mentor)\Code\content based filtering\newdataset.xlsx','Sheet1');
raw(cellfun(@(x) ~isempty(x) && isnumeric(x) && isnan(x),raw)) = {''};
cellVectors = raw(:,[1,2,3,4,5]);
raw = raw(:,[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35]);

%% Replace non-numeric cells with NaN
R = cellfun(@(x) ~isnumeric(x) && ~islogical(x),raw); % Find non-numeric cells
raw(R) = {NaN}; % Replace non-numeric cells

%% Create output variable
data = reshape([raw{:}],size(raw));

%% Create dataset array
newdataset= dataset;

%% Allocate imported array to column variable names
newdataset.VarName1 = cellVectors(:,1);
newdataset.track_id = cellVectors(:,2);
newdataset.artist_name = cellVectors(:,3);
newdataset.mood = cellVectors(:,4);
newdataset.title = cellVectors(:,5);
newdataset.loudness = data(:,1);
newdataset.tempo = data(:,2);
newdataset.time_signature = data(:,3);
newdataset.key = data(:,4);
newdataset.mode = data(:,5);
newdataset.duration = data(:,6);
newdataset.avg_timbre1 = data(:,7);
newdataset.avg_timbre2 = data(:,8);
newdataset.avg_timbre3 = data(:,9);
newdataset.avg_timbre4 = data(:,10);
newdataset.avg_timbre5 = data(:,11);
newdataset.avg_timbre6 = data(:,12);
newdataset.avg_timbre7 = data(:,13);
newdataset.avg_timbre8 = data(:,14);
newdataset.avg_timbre9 = data(:,15);
newdataset.avg_timbre10 = data(:,16);
newdataset.avg_timbre11 = data(:,17);
newdataset.avg_timbre12 = data(:,18);
newdataset.var_timbre1 = data(:,19);
newdataset.var_timbre2 = data(:,20);
newdataset.var_timbre3 = data(:,21);
newdataset.var_timbre4 = data(:,22);
newdataset.var_timbre5 = data(:,23);
newdataset.var_timbre6 = data(:,24);
newdataset.var_timbre7 = data(:,25);
newdataset.var_timbre8 = data(:,26);
newdataset.var_timbre9 = data(:,27);
newdataset.var_timbre10 = data(:,28);
newdataset.var_timbre11 = data(:,29);
newdataset.var_timbre12 = data(:,30);

%% Clear temporary variables
clearvars data raw cellVectors R;
C = dataset2cell(newdataset);
 song = input('song you wanna hear: ', 's');
  artist = input('Artist of the song: ', 's');
  test2=C(strcmpi(artist,C(:,3)),:);
 combined=test2(strcmpi(song,test2(:,5)),:);
  BC1=combined(1,1:5);
  BC2=combined(:,6:35);
   Bmat=cell2mat(BC2);
  BCmean=mean(Bmat(:,1:30),1);
   BCmean1=mat2dataset(BCmean);
   BCell=dataset2cell(BCmean1);
   BCell(1,:) = [];
   B=horzcat(BC1,BCell);ss
 C1=C(:,[6:35]);
 C1(1:2,:) = [];
B1=B(:,[6:35]);
 mat1=cell2mat(B1);
mat2=cell2mat(C1);
 [ncb,cheb] = knnsearch(mat1,mat2,'k',10,'distance','chebychev');
  cheb_cell=mat2dataset(cheb);
  song_title=newdataset(:,4:5);
  song_title(1,:) = [];
    only_song=newdataset(:,3);
only_genre=newdataset(:,1);
only=horzcat(only_song,only_genre);
only(1,:) = [];
   concat1 = horzcat(cheb_cell,only);
   concat = horzcat(song_title,cheb_cell);
   new=horzcat(concat,concat1);
   new = sortrows(new,'cheb1','ascend');
   new(1,:) = [];
    new = new(:,[1:2 4 3 end]);
    for_mood=new(1:200,:);
      final=for_mood(:,2:3);
      poopy=final(1:20,:);
       poopy1=dataset2cell(poopy);
        poopy1(1,:) = [];
      
display(poopy1);
 display('Moods:');
 display('Happy');
 display('Sad');
 display('Calm');
 display('Dreamy');
 display('Anger');
 display('Confident');
 display('Desire');
 display('Exciting');
 display('Fear');
 display('Pride');
 display('Romantic');
 display('Pleased');
 display('Not specific');
mood = input('How Are You Feeling Right Now : ', 's'); % APPLYING CLUSTERING
 if strcmpi(mood,'Happy')
moody=for_mood(strcmp('cluster5',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
 elseif strcmpi(mood,'Sad')
moody=for_mood(strcmp('cluster7',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
    elseif strcmpi(mood,'calm')
moody=for_mood(strcmp('cluster9',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
      elseif strcmpi(mood,'Dreamy')
moody=for_mood(strcmp('cluster0',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
     elseif strcmpi(mood,'Anger')
    moody=for_mood(strcmp('cluster11',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
elseif strcmpi(mood,'Confident')
    moody=for_mood(strcmp('cluster2',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
     elseif strcmpi(mood,'Desire')
    moody=for_mood(strcmp('cluster6',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
      elseif strcmpi(mood,'Exciting')
   moody=for_mood(strcmp('cluster4',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
      elseif strcmpi(mood,'Fear')
   moody=for_mood(strcmp('cluster8',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
     elseif strcmpi(mood,'Pleased')
  moody=for_mood(strcmp('cluster1',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
      elseif strcmpi(mood,'Pride')
  moody=for_mood(strcmp('cluster10',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
      elseif strcmpi(mood,'Romantic')
  moody=for_mood(strcmp('cluster3',for_mood.mood),:);
moody1=moody(:,2:3);
display(moody1);
 elseif strcmpi(mood,'not specific')
     display(final(1:20,:));
 else
     display('no such mood found in recommended list rest of the list is:');
      display(final(1:20,:));
 end
 
 
 display('classic pop and rock');
 display('Punk');
 display('Folk');
 display('Pop');
 display('Dance And Electronica');
 display('Metal');
 display('Jazz And Blues');
 display('Classical');
 display('Hip-Hop');
 display('Soul And Reggae');
 genre = input('CHOOSE FROM THE GENRES TO FURTHER FILTER: ', 's'); % FILTERING BASED ON GENRE

if strcmpi(genre,'classic pop and rock')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end
      elseif strcmpi(genre,'Punk')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end

elseif strcmpi(genre,'Folk')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end

 elseif strcmpi(genre,'Pop')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end
elseif strcmpi(genre,'Dance And Electronica')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end
elseif  strcmpi(genre,'Metal')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end

elseif  strcmpi(genre,'Jazz And Blues')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end

elseif  strcmpi(genre,'Classical')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end
      elseif  strcmpi(genre,'Hip-Hop')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end
elseif  strcmpi(genre,'Soul And Reggae')
  gen=moody(strcmp(genre,moody.VarName1),:);
gen1=gen(:,2:3);
tf=isempty(gen1);
if(tf==1)
    display('no such genre found try again');
    display('your previous result is:');
    display(moody1);
else
display(gen1);
end
elseif  strcmpi(genre,'No Genre')
  display(poopy1);



else
    display('no such genre found in recommended list rest of the list is');
     
     display(moody1);
end

    
  


